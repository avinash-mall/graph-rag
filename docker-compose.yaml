services:
  neo4j:
    image: neo4j:latest
    container_name: neo4j
    ports:
      - "7474:7474"
      - "7687:7687"
    environment:
      NEO4J_PLUGINS: '["graph-data-science", "apoc"]'
      NEO4J_AUTH: "neo4j/neo4j123"
      NEO4J_dbms_security_procedures_unrestricted: "gds.*"
      NEO4J_dbms_security_procedures_whitelist: "gds.*"
      # Memory configuration - increase limits significantly
      NEO4J_dbms_memory_heap_initial__size: "2G"
      NEO4J_dbms_memory_heap_max__size: "4G"
      NEO4J_dbms_memory_pagecache_size: "2G"
      NEO4J_dbms_memory_transaction_total_max: "8G"
      # Performance tuning
      NEO4J_dbms_memory_transaction_max: "2G"
      NEO4J_dbms_memory_transaction_database_max: "4G"
    volumes:
      # On Windows, use forward slashes in paths
      - "D:/neo4j_data:/data"
    restart: always
    # Docker container memory limit
    mem_limit: 8g
    memswap_limit: 8g
